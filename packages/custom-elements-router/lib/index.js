import{extend as t}from"@iosio/util";export{routing}from"@iosio/routing";const e=({transition:e,pathMap:o,noMatch:n,loadingIndicator:a,lazyMap:i})=>{var r,l,m,s,p=!0,h=`opacity ${e="number"==typeof e?e:!0===e?150:0}ms ease-in-out`,{routerSwitch:u}=routing,c=customElements,d=(t,e)=>((t=>{let e=t.lastElementChild;for(;e;)t.removeChild(e),e=t.lastElementChild})(t),t.appendChild(e)),g=(o,n)=>{if(clearTimeout(m),r=document.createElement(o),p||!e)return d(n,r);t(n.style,{transition:h,opacity:0}),m=setTimeout(()=>{d(n,r),t(n.style,{transition:h,opacity:1})},e?e+10:0)},y=()=>{let{next:t,toLast:e,noChange:r,replacedLast:m}=u({pathMap:o,noMatch:n}),s=l&&l();!s||!s.nodeName||e||m||r&&!p||(t&&c.get(t)?g(t,s):((t,e)=>{a&&g(a,e),i&&i[t]&&i[t]().then(()=>c.whenDefined(t).then(()=>o[location.pathname]===t&&g(t,e)))})(t,s))};return{mountTo:t=>(s&&s(),l=t,y(),p=!1,s=routing.$onChange(y))}};export{e as CustomElementsRouter};
