import{Component as t,h as o}from"preact";import{routing as a}from"@iosio/routing";export{routing}from"@iosio/routing";import{propsChanged as n,isObj as e,isFunc as s}from"@iosio/util";import{lazy as i,Suspense as r}from"preact/compat";const{routerSwitch:c}=a;class p extends t{constructor(t){super(t);let o=window.location.pathname;this.unsub=a.$onChange(()=>{const{pathname:t}=a;o!==t&&(this.setState(Object.create(null)),o=t)}),this.initial=!0}shouldComponentUpdate(t){const{next:a,toLast:e,noChange:s,replacedLast:i}=c({pathMap:t.pathMap,noMatch:t.noMatch,root:t.root});this.next=t=>o(a,t);let{pathMap:r,noMatch:p,root:h}=this.props;return t.root!==h||t.noMatch!==p||n(r||{},t.pathMap||{})||!(e||i||s)}componentDidMount(){this.initial=!1}componentWillUnmount(){this.unsub()}render({pathMap:t,noMatch:a,root:n,...e}){return o(this.initial?c({pathMap:t,noMatch:a,root:n}).next:this.next,e)}}const h=(t="")=>`${t} a:hover,${t} a:focus,${t} a:active,${t} a:link,${t} a:visited {color: inherit;text-decoration: none;background-color: transparent;outline: 0;-webkit-tap-highlight-color: transparent;}`,l=h(""),u=t=>e(t)?a.stringifyParams(t):t||"";class m extends t{componentDidMount(){const{listenTo:t,toPath:o,toParams:n}=this.props;if(t){let e,s,i=!1,r=()=>{const{pathname:t,search:o}=location;e=t,s=o,this.setState({isActive:i})};const c=()=>{const{pathname:a,search:c}=location;i=!1,"pathname"===t&&e!==a?(o===a&&(i=!0),r()):"search"===t&&s!==c?(u(n)===c&&(i=!0),r()):"url"===t&&(o+u(n)===a+c&&(i=!0),r())};this.unsub=a.$onChange(c),c(),e=location.pathname,s=location.pathname}}componentWillUnmount(){this.unsub&&this.unsub()}render({element:t,children:n,href:e,toPath:i=location.pathname,toParams:r,onClick:c,...p},{isActive:h}){const l={...t?{}:{href:e||i+u(r)},onClick:t=>{i&&(t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.stopPropagation&&t.stopPropagation(),t.preventDefault(),a.route(i,r)),c&&c()},...p};return o(t||"a",l,s(n)?n({...a,isActive:h}):n)}}const d=(t,a)=>{const n=i(t),e=a||(()=>o("div"));return function(t){return o(r,{fallback:o(e)},o(n,{...t}))}};export{m as Linkage,p as Router,l as anchorTagResetStyles,h as anchorTagResetStylesFn,d as lazyLoader};
//# sourceMappingURL=index.js.map
