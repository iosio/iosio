{"version":3,"file":"index.js","sources":["../src/util.js","../src/connect.js","../src/use.js"],"sourcesContent":["export const getArgs = (a) => Array.from(a);\nexport const newObj = () => Object.create(null);\n","import {Component, h} from \"preact\";\nimport {newObj} from \"./util\";\n\nexport const connectObi = (obis) => {\n\n    return Child => {\n        function Connected() {\n            let unsubs = [];\n            [].concat(obis).forEach(d => unsubs.push(d.$onChange(() => this.setState(newObj()))));\n            this.componentWillUnmount = () => unsubs.forEach(f => f());\n            this.render = () => h(Child, this.props, this.props.children);\n        }\n\n        return (Connected.prototype = new Component()).constructor = Connected;\n    };\n};\n","import {useCallback, useEffect, useState} from \"preact/hooks\";\nimport {getArgs, newObj} from \"./util\";\n\nexport const useForceUpdate = () => {\n    const [, set] = useState(newObj());\n    return useCallback(() => set(newObj()), [set]);\n};\n\nexport const useObi = (obis)=> {\n    let fu = useForceUpdate();\n    useEffect(() => {\n        let unsubs = [];\n        [].concat(obis).forEach(o => unsubs.push(o.$onChange(fu)));\n        return () => unsubs.forEach(f => f());\n    }, []);\n};\n"],"names":["newObj","Object","create","connectObi","obis","Child","Connected","unsubs","concat","forEach","d","push","$onChange","this","setState","componentWillUnmount","f","render","h","props","children","prototype","Component","constructor","useForceUpdate","set","useState","useCallback","useObi","fu","useEffect","o"],"mappings":"wHACaA,EAAS,IAAMC,OAAOC,OAAO,MCE7BC,EAAcC,GAEhBC,IACH,SAASC,IACL,IAAIC,EAAS,GACb,GAAGC,OAAOJ,GAAMK,QAAQC,GAAKH,EAAOI,KAAKD,EAAEE,UAAU,IAAMC,KAAKC,SAASd,QACzEa,KAAKE,qBAAuB,IAAMR,EAAOE,QAAQO,GAAKA,KACtDH,KAAKI,OAAS,IAAMC,EAAEb,EAAOQ,KAAKM,MAAON,KAAKM,MAAMC,UAGxD,OAAQd,EAAUe,UAAY,IAAIC,GAAaC,YAAcjB,GCVxDkB,EAAiB,KAC1B,OAASC,GAAOC,EAAS1B,KACzB,OAAO2B,EAAY,IAAMF,EAAIzB,KAAW,CAACyB,KAGhCG,EAAUxB,IACnB,IAAIyB,EAAKL,IACTM,EAAU,KACN,IAAIvB,EAAS,GAEb,MADA,GAAGC,OAAOJ,GAAMK,QAAQsB,GAAKxB,EAAOI,KAAKoB,EAAEnB,UAAUiB,KAC9C,IAAMtB,EAAOE,QAAQO,GAAKA,MAClC"}