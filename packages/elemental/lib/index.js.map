{"version":3,"file":"index.js","sources":["../src/util.js","../src/Elemental.js"],"sourcesContent":["import {isObj, isArray, def, isFunc, eventListener} from \"@iosio/util\";\n\n\nexport {eventListener}\n/*------------------ STYLES -------------------------- */\n\nexport const CONSTRUCTABLE_STYLE_SHEETS_AVAILABLE = \"adoptedStyleSheets\" in document;\n\n/**\n * creates a single style sheet. returns a function to update the same sheet\n * @param id\n * @param {node|| null} mount - pass the node to mount the style element to defaults to document head\n * @returns {function} for adding styles to the same stylesheet\n */\nexport const headStyleTag = (id, mount) => {\n    let style = document.createElement('style');\n    if (id) style.id = id;\n    style.appendChild(document.createTextNode(\"\"));\n    (mount || document.head).appendChild(style);\n    return (css) => (style.appendChild(document.createTextNode(css)), style);\n};\n\n\nexport const getShadowParent = elmnt => {\n    while (elmnt.parentNode && (elmnt = elmnt.parentNode)) if (elmnt instanceof ShadowRoot) return elmnt;\n    return document;\n};\n\n\nconst constructableStyleCache = {};\nconst constructableStyleTagFallbackCache = {};\n\nexport const DEFAULT_SHADOWROOT_HOST_CSS_RESETS = `:host, *, *::before, *::after {box-sizing: border-box;} `;\n\nexport const createStyleTag = (css) => {\n    let style = document.createElement('style');\n    style.appendChild(document.createTextNode(css));\n    return {\n        element: style,\n        update: (css) => style.textContent = css\n    };\n};\n\nexport const adoptStyles = (tag, element, cssString, async, useStyleTag) => {\n\n    cssString = (element.shadowRoot ? DEFAULT_SHADOWROOT_HOST_CSS_RESETS : '') + cssString;\n\n    if (CONSTRUCTABLE_STYLE_SHEETS_AVAILABLE && !useStyleTag) {\n        let adopter = element.shadowRoot || getShadowParent(element);\n\n        let constructable = constructableStyleCache[tag];\n        if (!constructable) {\n            constructable = new CSSStyleSheet();\n            constructable[async ? 'replace' : 'replaceSync'](cssString);\n            constructableStyleCache[tag] = constructable;\n        }\n\n        if (!([].concat(adopter.adoptedStyleSheets).includes(constructable))) {\n            adopter.adoptedStyleSheets = [...adopter.adoptedStyleSheets, constructable];\n        }\n    } else {\n        let style = constructableStyleTagFallbackCache[tag];\n        if (!style) {\n            style = createStyleTag(cssString).element;\n            constructableStyleTagFallbackCache[tag] = style;\n        }\n        (element.shadowRoot || element).appendChild(style.cloneNode(true));\n    }\n};\n\n/*------------------ TEMPLATES -------------------------- */\n\nexport const select = (host, selector) => (host.shadowRoot || host).querySelector(selector);\n\nexport const createRefs = (element, refs, selector) => {\n    return refs.reduce((acc, curr) => (acc[curr] = select(element, (selector || '') + curr), acc), {})\n};\n\n\nexport const createRefsFromIDs = (element, refs) => createRefs(element, refs, '#');\n\nconst tagTemplateCache = {};\n\nexport const appendTemplate = (tag, element, templateStr) => {\n    if (!tag || !element || !templateStr) return;\n    let el = element.shadowRoot || element;\n    let temp = tagTemplateCache[tag];\n    if (!temp) {\n        temp = document.createElement('template');\n        temp.innerHTML = templateStr;\n        tagTemplateCache[tag] = temp;\n    }\n    el.appendChild(temp.content.cloneNode(true));\n};\n\n\nexport const templateToHost = (host, html) => {\n    let temp = document.createElement('template');\n    temp.innerHTML = html;\n    host.innerHTML = '';\n    host.appendChild(temp.content.cloneNode(true));\n};\n\n\nexport const TemplateMapFactory = () => {\n    const cache = {};\n    return (id, content) => {\n        if (!cache[id]) {\n            const temp = document.createElement('template');\n            temp.innerHTML = content;\n            cache[id] = temp\n        }\n        return cache[id].content.cloneNode(true);\n    }\n};\n\n\n/*------------------ DOM -------------------------- */\n\n/*------------------ WEB COMPONENT -------------------------- */\n\nexport const isCustomElement = (el, isAttr) => {\n    if (!el.getAttribute || !el.localName) return false;\n    isAttr = el.getAttribute('is');\n    return el.localName.includes('-') || isAttr && isAttr.includes('-');\n};\n\n\nexport const updateAttribute = (node, attr, value) => {\n    (value === null || value === false || value === 'null' || value === 'false')\n        ? node.removeAttribute(attr)\n        : node.setAttribute(attr, isCustomElement(node) && (isObj(value) || isArray(value)) ? JSON.stringify(value) : value);\n};\n\nexport const propToAttr = (prop) => prop.replace(/([A-Z])/g, \"-$1\").toLowerCase();\nexport const attrToProp = (attr) => attr.replace(/-(\\w)/g, (all, letter) => letter.toUpperCase());\n\n\n/*------------------ STATE -------------------------- */\n/**\n * for parsing the incoming attributes into consumable props\n * @param value\n * @param type\n * @returns {{error: boolean, value: *}}\n */\nexport const formatType = (value, type) => {\n    type = type || String;\n    if (type == Boolean) value = [true, 1, \"\", \"1\", \"true\"].includes(value);\n    else if (typeof value == \"string\") {\n        value = type == Number\n            ? Number(value) : type == Object || type == Array\n                ? JSON.parse(value) : value;\n    }\n    if ({}.toString.call(value) == `[object ${type.name}]`) return {\n        value,\n        error: type == Number && Number.isNaN(value)\n    };\n    return {value, error: true};\n};\n\nexport const compose = (...mixins) => base =>\n    mixins.reduce((acc, curr) => {\n        acc = curr(acc);\n        return acc;\n    }, base);","import {def, isFunc} from \"@iosio/util\";\nimport {\n    adoptStyles,\n    appendTemplate,\n    attrToProp,\n    formatType,\n    propToAttr,\n    updateAttribute,\n    createStyleTag,\n    eventListener\n} from \"./util\";\n\nconst IGNORE_ATTR = Symbol();\n\n\nexport class Elemental extends HTMLElement {\n    constructor() {\n        super();\n        const {initAttrs} = this.constructor;\n        const {shadow, tag, styles, template, ids} = this.constructor;\n        this.prevProps = {};\n        this.props = {};\n        this.changedProps = [];\n        this.unsubs = [];\n        this.refs = {};\n        shadow && this.attachShadow({mode: 'open'});\n\n        const root = (this.shadowRoot || this);\n\n        this.mounted = new Promise(mount => (this._mount = mount));\n\n        let updatableStyleTag;\n\n        this.updateStyles = () => {\n            if (this.updatableStyles) {\n                let css = this.updatableStyles(this.props, this.prevProps);\n                if (!css) return;\n                if (!updatableStyleTag) {\n                    updatableStyleTag = createStyleTag(css);\n                    root.appendChild(updatableStyleTag.element)\n                } else updatableStyleTag.update(css);\n            }\n        };\n\n        let refsCache = {};\n        this.refs = new Proxy({}, {\n            get(target, key) {\n                if (key === 'refreshRefsCache') return () => refsCache = {};\n                if (!refsCache[key]) refsCache[key] = root.querySelector('#' + key);\n                return refsCache[key];\n            }\n        });\n\n        const render = () => {\n            if (styles) adoptStyles(tag, this, styles);\n            if (template) {\n                appendTemplate(tag, this, template);\n            }\n        };\n\n        //if there is a shadowRoot, then its safe to render\n        shadow && render();\n        const initialUpdate = () => {\n            !shadow && render();\n            this.renderer && this.renderer(root, this.props, this.prevProps, this.changedProps);\n            this.didMount && this.didMount(this.props, this.prevProps, this.changedProps);\n            this.hasMounted = true;\n            if (this.propLogic) {\n                const logic = this.propLogic(true);\n                Object.keys(this.props).forEach(prop => {\n                    logic[prop] && logic[prop](this.props[prop], this.refs);\n                });\n            }\n        };\n\n        const subsequentUpdate = () => {\n            this.renderer && this.renderer(root, this.props, this.prevProps, this.changedProps);\n            this.didUpdate && this.didUpdate(this.props, this.prevProps, this.changedProps);\n            if (this.propLogic) {\n                const logic = this.propLogic();\n                this.changedProps.forEach(prop => logic[prop] && logic[prop](this.props[prop], this.refs))\n            }\n        };\n\n        this.update = () => {\n            if (!this.processing) this.processing = this.mounted.then(_ => {\n                !this.hasMounted ? initialUpdate() : subsequentUpdate();\n                this.changedProps = [];\n                this.processing = false;\n            });\n            return this.processing;\n        };\n\n        let length = initAttrs.length;\n\n        while (length--) initAttrs[length](this);\n\n        this.update();\n\n        this.eventListener = (to, ev, cb, opts) => {\n            this.unsubs.push(eventListener(to, ev, cb, opts));\n        };\n\n        this.emit = (event, detail, opts = {}, from = this) => from.dispatchEvent(\n            new CustomEvent(event, {detail: detail, bubbles: true, composed: true, ...opts})\n        );\n\n        this.unsubSubs = () => {\n            this.unsubs.forEach(f => f && f());\n        };\n    }\n\n    connectedCallback() {\n        if (!this.hasMounted) this._mount();\n    }\n\n\n    attributeChangedCallback(attr, oldValue, newValue) {\n        if (this[IGNORE_ATTR] === attr || oldValue === newValue) return;\n        this[attrToProp(attr)] = newValue;\n    }\n\n\n    disconnectedCallback() {\n        if (this.isConnected) return;\n        this.willUnmount();\n        this.unsubSubs();\n    }\n\n    static get observedAttributes() {\n        let {prototype, propTypes, tag} = this;\n        this.initAttrs = [];\n        if (!propTypes) return [];\n        return Object.keys(propTypes).map(prop => {\n            let attr = propToAttr(prop);\n            let schema = propTypes[prop].name ? {type: propTypes[prop]} : propTypes[prop];\n            if (!(prop in prototype)) {\n                def(prototype, prop, {\n                    get() {\n                        return this.props[prop]\n                    },\n                    set(nextValue) {\n                        let {value, error} = formatType(nextValue, schema.type);\n                        if (error && value != null) console.error(`[${prop}] must be type [${schema.type.name}]`);\n                        if (value === this.props[prop]) return;\n                        this.changedProps.push(prop);\n                        if (schema.reflect) {\n                            this.mounted.then(() => {\n                                this[IGNORE_ATTR] = attr;\n                                updateAttribute(this, attr, schema.type === Boolean && !value ? null : value);\n                                this[IGNORE_ATTR] = false;\n                            });\n                        }\n                        this.prevProps[prop] = this.props[prop];\n                        this.props[prop] = value;\n                        this.update();\n                    }\n                });\n            }\n            schema.value && this.initAttrs.push(self => (self[prop] = schema.value));\n            return attr;\n        });\n    }\n\n\n    willUnmount() {\n\n    }\n}\n\nElemental.define = (...elements) => {\n    elements.forEach((e) => {\n        if (!e.tag) return console.error('The Elemental base class requires a tag name on the static \"tag\" property', e);\n        customElements.define(e.tag, e);\n    })\n};\n\n"],"names":["CONSTRUCTABLE_STYLE_SHEETS_AVAILABLE","document","headStyleTag","id","mount","style","createElement","appendChild","createTextNode","head","css","getShadowParent","elmnt","parentNode","ShadowRoot","constructableStyleCache","constructableStyleTagFallbackCache","DEFAULT_SHADOWROOT_HOST_CSS_RESETS","createStyleTag","element","update","textContent","adoptStyles","tag","cssString","async","useStyleTag","shadowRoot","adopter","constructable","CSSStyleSheet","concat","adoptedStyleSheets","includes","cloneNode","select","host","selector","querySelector","createRefs","refs","reduce","acc","curr","createRefsFromIDs","tagTemplateCache","appendTemplate","templateStr","el","temp","innerHTML","content","templateToHost","html","TemplateMapFactory","cache","isCustomElement","isAttr","getAttribute","localName","updateAttribute","node","attr","value","removeAttribute","setAttribute","isObj","isArray","JSON","stringify","propToAttr","prop","replace","toLowerCase","attrToProp","all","letter","toUpperCase","formatType","type","String","Boolean","Number","Object","Array","parse","toString","call","name","error","isNaN","compose","mixins","base","IGNORE_ATTR","Symbol","Elemental","HTMLElement","constructor","super","initAttrs","this","shadow","styles","template","prevProps","props","changedProps","unsubs","attachShadow","mode","root","updatableStyleTag","mounted","Promise","_mount","updateStyles","updatableStyles","refsCache","Proxy","get","target","key","render","initialUpdate","renderer","didMount","hasMounted","propLogic","logic","keys","forEach","subsequentUpdate","didUpdate","processing","then","_","length","eventListener","to","ev","cb","opts","push","emit","event","detail","from","dispatchEvent","CustomEvent","bubbles","composed","unsubSubs","f","connectedCallback","attributeChangedCallback","oldValue","newValue","disconnectedCallback","isConnected","willUnmount","observedAttributes","prototype","propTypes","map","schema","def","set","nextValue","console","reflect","self","define","elements","e","customElements"],"mappings":"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"}