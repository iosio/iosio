import{extend as t}from"@iosio/util";import{routing as e}from"@iosio/routing";export{routing}from"@iosio/routing";const o=({transition:o,pathMap:n,noMatch:i,loadingIndicator:a,lazyMap:r})=>{var l,m,s,p,h=!0,c=`opacity ${o="number"==typeof o?o:!0===o?150:0}ms ease-in-out`,{routerSwitch:u}=e,d=customElements,f=(t,e)=>((t=>{let e=t.lastElementChild;for(;e;)t.removeChild(e),e=t.lastElementChild})(t),t.appendChild(e)),g=(e,n)=>{if(clearTimeout(s),l=document.createElement(e),h||!o)return f(n,l);t(n.style,{transition:c,opacity:0}),s=setTimeout(()=>{f(n,l),t(n.style,{transition:c,opacity:1})},o?o+10:0)},y=()=>{let{next:t,toLast:e,noChange:o,replacedLast:l}=u({pathMap:n,noMatch:i}),s=m&&m();!s||!s.nodeName||e||l||o&&!h||(t&&d.get(t)?g(t,s):((t,e)=>{a&&g(a,e),r&&r[t]&&r[t]().then(()=>d.whenDefined(t).then(()=>n[location.pathname]===t&&g(t,e)))})(t,s))};return{mountTo:t=>(p&&p(),m=t,y(),h=!1,p=e.$onChange(y))}};export{o as CustomElementsRouter};
